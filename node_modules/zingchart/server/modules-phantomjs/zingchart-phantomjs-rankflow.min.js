/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.3
*/
zingchart.setModule("rankflow"),function(){function e(e){var a,o=[],n=[],p=!1;for(a=0;a<t;a++)p=p||r["s"+a];for(a=0;a<t;a++){for(i=0;i<l;i++)o.push({id:"flow_"+a+"_"+i,alpha:r["s"+a]||!p?1:.25});n.push({id:"box_overall_"+a,alpha:r["s"+a]||!p?1:.25});for(var i=0;i<l;i++)n.push({id:"box_"+a+"_"+i,alpha:r["s"+a]||!p?1:.25,"text-alpha":r["s"+a]||!p?1:.25})}zingchart.exec(e.id,"updateobject",{type:"shape",graphid:e.graphid,data:o,update:!1}),zingchart.exec(e.id,"updateobject",{type:"label",graphid:e.graphid,data:n,update:!1}),zingchart.exec(e.id,"repaintobjects",{graphid:e.graphid})}ZC.ZCRankFlow=function(){var e=function(){this.AEW="palette",this.C1="#6a921f",this.BP=[],this.K5=!1,this.AGH=function(){for(var e=(16777215*Math.random()+1<<0).toString(16);e.length<6;)e="0"+e;return"#"+e}};return e.getDefaults=function(a){var t={};return ZC._cp_(e.B8,t),e.NU[a]&&ZC._cp_(e.NU[a],t),t},e.B8={},e.NU={light:{item:{bold:!0,color:"#808285"},"rank-side":{generated:!0,color:"#fff",bold:!0,"background-color":"#929497"},"rank-overall":{generated:!0,color:"#fff",bold:!0,"background-color":"#57585B"},flow:{generated:!0,shadow:!1}},dark:{item:{bold:!0,color:"#D1D3D4"},"rank-side":{generated:!0,color:"#fff",bold:!0,"background-color":"#929497"},"rank-overall":{generated:!0,color:"#fff",bold:!0,"background-color":"#57585B"},flow:{generated:!0,shadow:!1}},classic:{item:{bold:!0,color:"#D1D2D3"},"rank-side":{generated:!0,color:"#000",bold:!0,"background-color":"#999"},"rank-overall":{generated:!0,color:"#fff",bold:!0,"background-color":"#333"},flow:{generated:!0,shadow:!0}}},e}();var a,t=0,l=0,r=null;zingchart.bind(null,"label_click",function(a){var l=zingchart.getLoader(a.id);if(l){var o=zingchart.getGraph(l,a.graphid);if(o&&"rankflow"===o.o.type){if(!r){r={};for(var n=0;n<t;n++)r["s"+n]=!1}if("box_overall_"===a.labelid.substring(0,12)){var p=ZC._i_(a.labelid.split("_")[2]);r["s"+p]=!r["s"+p],e(a)}}}}),zingchart.bind(null,"dataparse",function(e,r){var o,n,p,i,_,h,c=zingchart.getLoader(e.id);zingchart.initThemes(c);for(var s=ZC.ZCRankFlow.getDefaults(e.theme),d=0,g=r.graphset.length;d<g;d++)if(r.graphset[d].type&&"rankflow"===r.graphset[d].type){var f=r.graphset[d].type,C=r.graphset[d];ZC._todash_(C);var u={};C.options&&(u=C.options[f]||C.options),ZC._todash_(u);var Z=u.style||{},b=zingchart.getGraphInfo(c,r,d);C.shapes||(C.shapes=[]),C.labels||(C.labels=[]),a=new ZC.ZCRankFlow;var x=!0;null!==ZC._n_(o=u["global-ranking"])&&(x=ZC._b_(o)),null!==ZC._n_(o=u["color-type"])&&(a.AEW=o),null!==ZC._n_(o=u.color)&&(a.C1=ZC.AO.G7(o)),null!==ZC._n_(o=u.palette)&&(a.BP=o),null!==ZC._n_(o=u.flat)&&(a.K5=ZC._b_(o));var k=[],v=[],w=C["scale-x"]||{};w.item=C["scale-x"].item||{},(o=w.values)&&(k=o),(o=w.labels)&&(v=o);var y=C.series;for(n=0;n<y.length;n++)y[n].rank=y[n].rank||n+"";y.sort(function(e,a){return e.rank-a.rank});var m,z,B=0,I=0,A=0,D=0,Q=0;for(n=0;n<v.length;n++)(z={}).text=v[n],ZC._cp_(s.item,z),ZC._cp_(z,w.item),(m=zingchart.getInstance(c,"textbox")).append(z),m.parse(),B=ZC.BQ(B,m.I),A=ZC.BQ(A,m.F);for(n=0;n<y.length;n++)i=y[n].style||{},z={text:y[n].text},ZC._cp_(Z["item-flow"],z),ZC._cp_(i["item-flow"],z),(m=zingchart.getInstance(c,"textbox")).append(z),m.parse(),B=ZC.BQ(B,m.I),I=ZC.BQ(I,m.F);for(z={text:n,bold:!0},(m=zingchart.getInstance(c,"textbox")).append(z),m.parse(),(D=ZC.BQ(D,m.I))<I&&(D=I),z={generated:!0,text:n,bold:!0,width:2*D},ZC._cp_(Z["rank-overall"],z),(m=zingchart.getInstance(c,"textbox")).append(z),m.parse(),(Q=ZC.BQ(Q,m.I))<I&&(Q=I),t=y.length,l=ZC.BQ(k.length,v.length),n=0;n<t;n++)h=y[n].ranks||[],l=ZC.BQ(l,h.length);var E=[0,0,0,0];null!==ZC._n_(o=u.margin)&&(E=zingchart.getInstance(c,"box").m_(o,"all",b.plotarea.width,b.plotarea.height)),b.plotarea.x+=E[3],b.plotarea.y+=E[0],b.plotarea.width-=E[1]+E[3],b.plotarea.height-=E[0]+E[2];var P,R=20;null!==ZC._n_(o=u["sep-space"])&&(R=ZC._i_(o)),x?P=(b.plotarea.width-Q-R-3*D-(l+1)*B)/(l-1):(R=0,P=(b.plotarea.width-3*D-l*B)/(l-1));var F=ZC._i_((b.plotarea.height-A-y.length*I)/(y.length+1));null!==ZC._n_(o=u["col-space"])&&(P=ZC._i_(o)),null!==ZC._n_(o=u["row-space"])&&(F=ZC._i_(o));var G,K;if(G=b.plotarea.x,K=b.plotarea.y,A>0)for(z={generated:!0,bold:!0,text:"OVERALL<br>RANK",flat:!0},ZC._cp_(w.item,z),ZC._cp_(Z["label-overall"],z),ZC._cp_({x:G,y:K,width:Q+B},z),x&&C.labels.push(z),n=0;n<v.length;n++)G=b.plotarea.x+(x?Q+B+R:0)+1.5*D+n*(B+P),K=b.plotarea.y,z={generated:!0,bold:!0},ZC._cp_(w.item,z),ZC._cp_({x:G,y:K,width:B,flat:!0,text:v[n]},z),C.labels.push(z);for(n=0;n<t;n++)G=b.plotarea.x+(x?Q+B+R:0),K=b.plotarea.y+A+F+n*(I+F),z={},ZC._cp_(s["rank-side"],z),ZC._cp_(Z["rank-left"],z),ZC._cp_({id:"rank_"+(n+1)+"_l",x:G,y:K,width:D,height:I,flat:!0,text:n+1},z),C.labels.push(z),G=b.plotarea.x+(x?Q+B+R:0)+2*D+l*(B+P)-P,z={},ZC._cp_(s["rank-side"],z),ZC._cp_(Z["rank-right"],z),ZC._cp_({id:"rank_"+(n+1)+"_r",x:G,y:K,width:D,height:I,flat:!0,text:n+1},z),C.labels.push(z),G=b.plotarea.x,z={},ZC._cp_(s["rank-overall"],z),ZC._cp_(Z["rank-overall"],z),ZC._cp_({id:"rank_"+(n+1)+"_g",x:G,y:K,width:Q,height:I,flat:!0,text:n+1},z),x&&C.labels.push(z);for(n=0;n<y.length;n++)for(i=y[n].style||{},_=a.C1,"palette"===a.AEW?_=a.BP.length>0?a.BP[n%a.BP.length]:zingchart.getPalette(c,n,"bar")[1]:"random"===a.AEW&&(_=a.AGH()),G=b.plotarea.x+Q,K=b.plotarea.y+A+F+n*(I+F),-1!==(y[n].ranks||-1)&&(z={generated:!0,"background-color":_,color:"#fff"},ZC._cp_(Z["item-overall"],z),ZC._cp_(i["item-overall"],z),ZC._cp_({id:"box_overall_"+n,x:G,y:K,width:B,height:I,flat:a.K5,text:y[n].text},z),x&&C.labels.push(z)),h=y[n].ranks,p=0;p<h.length;p++)if(null!==ZC._n_(h[p])){var L=[];if(G=b.plotarea.x+(x?Q+B+R:0)+1.5*D+p*(B+P),K=b.plotarea.y+A+F+(h[p]-1)*(I+F),null!==ZC._n_(h[p+1])){var N=b.plotarea.x+(x?Q+B+R:0)+1.5*D+(p+1)*(B+P),W=b.plotarea.y+A+F+(h[p+1]-1)*(I+F);L.push([G,K]),L.push([G+B,K]),L.push([N,W]),L.push([N+B,W]),L.push([N+B,W+I]),L.push([N,W+I]),L.push([G+B,K+I]),L.push([G,K+I])}else L.push([G,K]),L.push([G+B,K]),L.push([G+B,K+I]),L.push([G,K+I]);var j={};j["background-color"]=_,ZC._cp_(s.flow,j),ZC._cp_(C.plot,j),ZC._cp_(y[n],j),ZC._cp_(Z.flow,j),ZC._cp_(i.flow,j),ZC._cp_({id:"flow_"+n+"_"+p,type:"poly",points:L,flat:!0,label:{visible:!1}},j),C.shapes.push(j);var O={"background-color":"#fff",color:"#333","border-width":1,"border-color":"#999",padding:10,text:"%text ranked on %rank at %scale-value"};ZC._cp_(Z.tooltip,O),ZC._cp_(i.tooltip,O),O.text=O.text.replace(/%text/gi,y[n].text).replace(/%rank/gi,h[p]).replace(/%scale-value/gi,k[p]);for(var U in y[n])-1!==U.indexOf("data-")&&(O.text=O.text.replace(new RegExp("%"+U,"g"),y[n][U][p]||""));z={generated:!0,color:"#fff"},ZC._cp_(Z["item-flow"],z),ZC._cp_(i["item-flow"],z),ZC._cp_({id:"box_"+n+"_"+p,x:G,y:K,width:B,height:I,text:y[n].text,tooltip:O},z),C.labels.push(z)}}return r})}();